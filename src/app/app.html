<div class="p-6 bg-[#123836] min-h-screen">
  <div class="flex flex-col items-center mb-24">
    <svg width="90%" height="40" viewBox="0 0 900 40" class="mb-[-10px]">
      <path
        d="M20,30 Q450,0 880,30"
        stroke="#FF645A"
        stroke-width="5"
        fill="none"
        filter="url(#glow)"
      />
      <defs>
        <filter id="glow" x="-100%" y="-100%" width="200%" height="200%">
          <feGaussianBlur stdDeviation="6" result="coloredBlur" />
          <feMerge>
            <feMergeNode in="coloredBlur" />
            <feMergeNode in="SourceGraphic" />
          </feMerge>
        </filter>
      </defs>
    </svg>
    <span class="text-xs text-gray-500 tracking-widest mt-[-8px]">SCREEN</span>
  </div>

  <!-- Control Panel -->
  <!-- <div class="max-w-4xl mx-auto mb-6 p-4 bg-white rounded-lg shadow">
    <div class="flex flex-wrap gap-4 items-center justify-center">
      <button
        (click)="exportSeatingChart()"
        class="px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition-colors"
      >
        Export Seating Chart
      </button>

      <button
        (click)="clearAllSeats()"
        class="px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors"
      >
        Clear All Assignments
      </button>
    </div>

    <div *ngIf="editMode" class="text-sm text-gray-600 mt-2 text-center">
      <strong>Edit Mode:</strong> Click cells to toggle visibility (create
      pathways, remove unwanted seats)
    </div>
  </div> -->

  <!-- Theater Layout -->
  <div class="max-w-full mx-auto overflow-x-auto">
    <div class="inline-block min-w-full">
      <div
        class="grid gap-2 justify-center"
        [style.grid-template-columns]="getGridTemplate()"
      >
        <div
          *ngFor="let seat of seats"
          class="w-8 h-8 text-xs flex items-center justify-center cursor-pointer relative transition-all duration-200 rounded-md"
          [ngClass]="{
            'bg-seat-available':
              !seat.isHidden && !seat.audienceId && !seat.disabled,
            'bg-seat-taken':
              !seat.isHidden && seat.audienceId && !seat.disabled,
            'bg-seat-selected':
              !seat.isHidden && seat.isSelected && !seat.disabled,
            'bg-gray-300 text-gray-400 cursor-not-allowed opacity-35':
              seat.disabled && !seat.isHidden,
            'bg-seat-hidden': seat.isHidden,
            'border-gray-400': !seat.isHidden,
            invisible: seat.isHidden
          }"
          (click)="editMode ? toggleSeatVisibility(seat) : selectSeat(seat)"
        >
          <!-- Seat ID Display -->
          <span
            *ngIf="!seat.isEditing && !seat.isHidden"
            class="font-semibold text-black"
            >{{ seat.id }}</span
          >

          <!-- <span>{{ seat.disabled ? "true" : "false" }}</span> -->

          <!-- Hidden cell indicator in edit mode -->
          <span *ngIf="seat.isHidden && editMode" class="text-gray-400">Ã—</span>

          <!-- Input for editing -->
          <div
            *ngIf="seat.isEditing && !seat.isHidden"
            class="absolute inset-0 z-10"
          >
            <input
              type="text"
              [(ngModel)]="tempAudienceId"
              (keyup.enter)="saveSeat(seat)"
              (blur)="cancelEdit(seat)"
              (input)="filterSuggestions()"
              class="w-full h-full text-xs text-center focus:outline-none"
              #inputRef
            />

            <div
              *ngIf="filteredSuggestions.length > 0"
              class="absolute top-full left-1/2 transform -translate-x-1/2 bg-white border border-gray-300 rounded-md shadow-lg max-h-32 overflow-y-auto z-40"
              style="
                min-width: 180px;
                box-shadow: 0 2px 12px rgba(0, 0, 0, 0.12);
              "
            >
              <div
                *ngFor="let suggestion of filteredSuggestions"
                class="px-2 py-1 hover:bg-gray-100 cursor-pointer text-xs"
                (click)="selectSuggestion(suggestion, seat)"
              >
                <div class="font-semibold">{{ suggestion.id }}</div>
                <div class="text-gray-600">{{ suggestion.name }}</div>
              </div>
            </div>
          </div>

          <!-- Tooltip showing audience info -->
          <!-- <div
            *ngIf="seat.audienceId && !seat.isEditing && !seat.isHidden"
            class="absolute -top-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-0 hover:opacity-100 transition-opacity z-30 whitespace-nowrap"
          >
            <div class="font-semibold">{{ seat.audienceId }}</div>
            <div>{{ getAudienceName(seat.audienceId) }}</div>
          </div> -->
          <div
            *ngIf="
              seat.audienceId &&
              seat.isSelected &&
              !seat.isEditing &&
              !seat.isHidden
            "
            class="absolute left-1/2 top-full mt-2 transform -translate-x-1/2 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 w-64"
          >
            <div class="flex items-center space-x-3 justify-between">            
              <div>
                <div class="font-bold text-lg">{{ seat.audienceId }}</div>
                <div class="text-gray-700">
                  {{ getAudienceName(seat.audienceId) }}
                </div>
              </div>
              <span class='text-4xl font-bold'>{{seat.id}}</span>
            </div>
            <button
              (click)="removeSeat(seat)"
              class="mt-4 px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600"
            >
              Remove Assignment
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="max-w-4xl mx-auto mb-8 mt-10">
    <button
      (click)="exportSeatingChart()"
      class="flex items-center justify-between w-48 px-6 py-3 bg-[#123836] rounded-md"
      style="font-size: 1.5rem; font-weight: 400; color: #fff"
    >
      <span>Export</span>
      <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
        <path
          d="M12 18H28M28 18L22 12M28 18L22 24"
          stroke="#FF645A"
          stroke-width="3"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
  </div>
</div>
